<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>HMGCC Pen cipher challenge &#8211; AabyWan's blog</title>
<meta name="description" content="One of the challenges from UK Cyber Challenge F2F hosted by HMGCC">
<meta name="keywords" content="HMGCC, UK Cyber Security Challenge">

<!-- Twitter Cards -->
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="/images/">
<meta name="twitter:title" content="HMGCC Pen cipher challenge">
<meta name="twitter:description" content="One of the challenges from UK Cyber Challenge F2F hosted by HMGCC">
<meta name="twitter:creator" content="@aabywan">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="HMGCC Pen cipher challenge">
<meta property="og:description" content="One of the challenges from UK Cyber Challenge F2F hosted by HMGCC">
<meta property="og:url" content="/HMGCC-pen-cipher/">
<meta property="og:site_name" content="AabyWan's blog">





<link rel="canonical" href="/HMGCC-pen-cipher/">
<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="AabyWan's blog Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<!-- Webfonts -->
<link href="//fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic" rel="stylesheet" type="text/css">

<meta http-equiv="cleartype" content="on">

<!-- Load Modernizr -->
<script src="/assets/js/vendor/modernizr-2.6.2.custom.min.js"></script>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/images/apple-touch-icon-144x144-precomposed.png">



</head>

<body id="post" >

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->
<nav id="dl-menu" class="dl-menuwrapper" role="navigation">
	<button class="dl-trigger">Open Menu</button>
	<ul class="dl-menu">
		<li><a href="/">Home</a></li>
		<li>
			<a href="#">About</a>
			<ul class="dl-submenu">
				<li>
					<img src="/images/avatar.jpg" alt="Peter Aaby photo" class="author-photo">
					<h4>Peter Aaby</h4>
					<p>Bio from _config</p>
				</li>
				<li><a href="/about/"><span class="btn btn-inverse">Learn More</span></a></li>
				<li>
					<a href="mailto:blog@aabywan.com"><i class="fa fa-fw fa-envelope"></i> Email</a>
				</li>
				<li>
					<a href="https://twitter.com/aabywan"><i class="fa fa-fw fa-twitter"></i> Twitter</a>
				</li>
				
				
				
				<li>
					<a href="https://github.com/aabywan"><i class="fa fa-fw fa-github"></i> GitHub</a>
				</li>
				
				
				
				
			</ul><!-- /.dl-submenu -->
		</li>
		<li>
			<a href="#">Posts</a>
			<ul class="dl-submenu">
				<li><a href="/posts/">All Posts</a></li>
				<li><a href="/tags/">All Tags</a></li>
			</ul>
		</li>
		
	</ul><!-- /.dl-menu -->
</nav><!-- /.dl-menuwrapper -->




<div id="main" role="main">
  <article class="hentry">
    <header class="header-title">
      <div class="header-title-wrap">
        
          <h1 class="entry-title"><a href="/HMGCC-pen-cipher/" rel="bookmark" title="HMGCC Pen cipher challenge">HMGCC Pen cipher challenge</a></h1>
        
        <h2><span class="entry-date date published"><time datetime="2017-08-10T00:00:00+01:00">August 10, 2017</time></span></h2>
        
        <p class="entry-reading-time">
          <i class="fa fa-clock-o"></i>
          
Reading time ~4 minutes
        </p><!-- /.entry-reading-time -->
        
      </div><!-- /.header-title-wrap -->
    </header>
    <div class="entry-content">
      <h1 id="hidden-challenge-in-plain-sight">Hidden challenge in plain sight</h1>
<p>On Friday 11 August, <a href="http://www.hmgcc.gov.uk/">HMGCC</a> hosted the third out of five Face to Face events at the UK Defence Academy which is part of the 2017 <a href="https://www.cybersecuritychallenge.org.uk/competitions/face-to-face">Cyber Security Challenge UK</a> masterclass qualifiers.</p>

<p>As host, HMGCC found the perfect environment to host a cyber security challenge and it was within this environment that they managed to hide one of their challenges in plain sight; a swag pen with HEX characters combining into the letters <strong>HMGCC</strong>. It took the better of an hour before officials had to announce that everybody had to ‚Äúsearch their tables for any foreign objects‚Äù. A pen had for each team member been placed on our desks overnight, and I personally (as well as everyone else) did not think any more of this until the hint was announced.</p>

<figure>
    
    <a href="/images/posts/hmgcc-hex-pen.jpg"><img src="/images/posts/hmgcc-hex-pen.jpg" alt="" /></a>
    
    <figcaption></figcaption>
</figure>

<h1 id="pen-hex-values-digitalized">Pen HEX values digitalized</h1>
<p>The obvious first step was to digitalise the HEX values found on the pen. However, some of the letters and digits caused issues as it was hard to distinguish S and 5 from each other. Therefore, first attempt failed and my team mate Eed gave a helping hand by checking for typo‚Äôs. Below is the final digital printout which is the basis of the challenge.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>A5     97  0E      CD  3CF2A0   F3BFAF  2418FC
E2     CB  C906  6EBD  3A       F2      CA
B972E5CB9  72  EA  59  70  ECD  3C      F2
A0     F3  BF  AF  24  18  FC   E2      CB
C9     06  6E      BD  3AF2CA   B972E5  CB972E
</code></pre>
</div>
<p>With the HEX values captured, an initial conversion from HEX to ASCII was attempted using <a href="https://www.asecuritysite.com/coding/ascii?hex=62657274&amp;hex=62657274">asecuritysite‚Äôs ASCII, Hex, Base-64 and Binary convertor</a>. The results did not return 100% positive. However, the ASCII conversion gave away that the HEX values had been duplicated. At this moment, we got stuck and the time presure with other challenges due made us decide on utilising one of our free hints (hint disclosed in next section).</p>

<p>We did not have enough time to program anything during the challenge, thus the above website was used for analysis and conversion from HEX to ASCII. After the challenge, I decided that it would be interesting to script a solution and below code snippet shows how it could have been done using Python 2.7.</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">binascii</span>

<span class="nb">hex</span> <span class="o">=</span> <span class="s">"""   A5     97  0E      CD  3CF2A0   F3BFAF  2418FC
            E2     CB  C906  6EBD  3A       F2      CA
            B972E5CB9  72  EA  59  70  ECD  3C      F2
            A0     F3  BF  AF  24  18  FC   E2      CB
            C9     06  6E      BD  3AF2CA   B972E5  CB972E"""</span>

<span class="nb">hex</span> <span class="o">=</span> <span class="nb">hex</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="s">' </span><span class="se">\n</span><span class="s">'</span><span class="p">)</span> <span class="c">#remove whitespace and newlines</span>
<span class="k">print</span> <span class="s">"Hex in ASCII</span><span class="se">\t</span><span class="s">"</span><span class="p">,</span><span class="n">binascii</span><span class="o">.</span><span class="n">unhexlify</span><span class="p">(</span><span class="nb">hex</span><span class="p">)</span>
<span class="k">print</span> <span class="s">"Count of bytes:"</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="nb">hex</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="s">"bytes</span><span class="se">\n</span><span class="s">"</span>
</code></pre>
</div>

<p>Python printout:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>Hex in ASCII	ÔøΩÔøΩÔøΩ&lt;ÔøΩÔøΩ$ÔøΩÔøΩÔøΩÔøΩnÔøΩ:ÔøΩ πrÔøΩÀó.ÔøΩÔøΩÔøΩ&lt;ÔøΩÔøΩ$ÔøΩÔøΩÔøΩÔøΩnÔøΩ:ÔøΩ πrÔøΩÀó.
Count of bytes: 56 bytes
</code></pre>
</div>

<p>As mentioned before, the data duplication can be seen above by the repeating pattern of <strong>ÔøΩ πrÔøΩÀó.</strong> in the middle and at the end of the HEX string. Effectively, the HEX stream can be cut in half or in its entirety. I leave it thus expect the result to come out twice when solved. Double the points, right? :)</p>

<p>Being under time pressure, we decided to leave two team mates working on other challenges, while me and Eed continued with help from the new hint.</p>

<h1 id="hint-spoilers-and-solution-below">Hint (spoilers and solution below)</h1>
<p>As time progressed, we decided on utilising one of our free hints. It turned out, that we had already passed the first two hints prepared by the officials and we could therefore only get the last one. Mixed feelings, as it meant we had gotten really close, but if we couldn‚Äôt make use of the hint then time would have been wasted.</p>

<p>You are waiting for the hint, aren‚Äôt you?</p>

<p>Ok, so the hint is simply <strong>SMS</strong></p>

<p>We did not know what to make of it, but raced to Google and  started searching for SMS decoders and quickly discovered an <a href="https://www.diafaan.com/sms-tutorials/gsm-modem-tutorial/online-sms-pdu-decoder/">Online SMS PDU Decoder</a>. This site takes HEX values as input and convert data-streams into readable SMS text messages. Win?! Sadly not, a dead end and we returned to research further into SMS protocols.</p>

<p>At this moment, we still didn‚Äôt really know if we had decoded the HEX values correctly, but the duplicated values pointed in the right direction. Thankfully, it didn‚Äôt take long till we discovered <a href="https://en.wikipedia.org/wiki/GSM_03.38">GSM 03.38</a>, a 7-bit GSM alphabet which could have been used to generate the hidden message.</p>

<p>From the online conversion on <a href="https://www.asecuritysite.com/coding/ascii?hex=62657274&amp;hex=62657274">asecuritysite</a>, each HEX value had already been converted to binary and we simply copied this manually into a text editor and began deciphering by cutting the bit stream into chunks of 7.</p>

<p>Below is a snippet of the manual process which was used to positively produce the correct answer. HURRAY!</p>

<div class="highlighter-rouge"><pre class="highlight"><code>Binary	HEX	ASCII
1010010 52	R
1100101	65	e
1100001 61 	a 
1101100 6C 	l
.
.
.
.
1110100 74 	t 
1110101 75 	u 
1110010 72 	r 
1100101 65 	e 
</code></pre>
</div>

<p>Fully automated using Python 2.7 and the bitstring module.</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">bitstring</span>
<span class="n">binaryString</span> <span class="o">=</span> <span class="nb">bin</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">hex</span><span class="p">,</span><span class="mi">16</span><span class="p">))</span>
<span class="nb">bytes</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">bitstring</span><span class="o">.</span><span class="n">BitArray</span><span class="p">(</span><span class="n">binaryString</span><span class="p">)</span>
<span class="k">for</span> <span class="n">byte</span> <span class="ow">in</span> <span class="n">b</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="mi">7</span><span class="p">):</span> <span class="c">#cut bytestream into chunks of 7-bytes</span>
    <span class="k">print</span> <span class="nb">chr</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">byte</span><span class="o">.</span><span class="nb">bin</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="c">#conv datatypes and print bin&gt;int&gt;char</span>
</code></pre>
</div>

<p>Python printout:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>R
e
a
l
i
s
e
 
y
o
u
r
 
c
y
b
e
r
 
f
u
t
u
r
e
.
.
.
.
.
.
.
R
e
a
l
i
s
e
 
y
o
u
r
 
c
y
b
e
r
 
f
u
t
u
r
e
.
.
.
.
.
.
.
</code></pre>
</div>

<p>Browsing to <a href="http://www.hmgcc.gov.uk">HMGCC‚Äôs</a> website, have a look at the top left logo and picture with a similar quote. Picture linked below.</p>

<p>Thanks to HMGCC for the challenge, now to the second pen that was handed out by the end of the Face to Face challenge :)</p>

<figure class="half">
	<img src="http://www.hmgcc.gov.uk/assets/img/logo.png" alt="" />
</figure>

      <footer class="entry-meta">
        <span class="entry-tags"><a href="/tags/#HMGCC" title="Pages tagged HMGCC" class="tag"><span class="term">HMGCC</span></a><a href="/tags/#UK Cyber Security Challenge" title="Pages tagged UK Cyber Security Challenge" class="tag"><span class="term">UK Cyber Security Challenge</span></a></span>
        
        <div class="social-share">
  <ul class="socialcount socialcount-small inline-list">
    <li class="facebook"><a href="https://www.facebook.com/sharer/sharer.php?u=/HMGCC-pen-cipher/" title="Share on Facebook"><span class="count"><i class="fa fa-facebook-square"></i> Like</span></a></li>
    <li class="twitter"><a href="https://twitter.com/intent/tweet?text=/HMGCC-pen-cipher/" title="Share on Twitter"><span class="count"><i class="fa fa-twitter-square"></i> Tweet</span></a></li>
    <li class="googleplus"><a href="https://plus.google.com/share?url=/HMGCC-pen-cipher/" title="Share on Google Plus"><span class="count"><i class="fa fa-google-plus-square"></i> +1</span></a></li>
  </ul>
</div><!-- /.social-share -->
      </footer>
    </div><!-- /.entry-content -->
    
    <div class="read-more">
  
    <div class="read-more-header">
      <a href="" class="read-more-btn">Read More</a>
    </div><!-- /.read-more-header -->
    <div class="read-more-content">
      <h3><a href="/HMGCC-f2f/" title="HMGCC F2F masterclass qualifier">HMGCC F2F masterclass qualifier</a></h3>
      <p>Qualified for the F2F challenges through the UK Cyber Challenge Play on Demand system <a href="/HMGCC-f2f/">Continue reading</a></p>
    </div><!-- /.read-more-content -->
  
  <div class="read-more-list">
    
  </div><!-- /.read-more-list -->
</div><!-- /.read-more -->
  </article>
</div><!-- /#main -->

<div class="footer-wrapper">
  <footer role="contentinfo">
    <span>&copy; 2017 Peter Aaby.</span>
  </footer>
</div><!-- /.footer-wrapper -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="/assets/js/scripts.min.js"></script>



	        

</body>
</html>
